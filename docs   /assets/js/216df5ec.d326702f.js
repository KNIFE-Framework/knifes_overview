"use strict";(globalThis.webpackChunkknife_preview=globalThis.webpackChunkknife_preview||[]).push([[2717],{2951:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"sk/knifes/K000067-github-deployment-strategie/K000067_makefile_appendix","title":"K000067 Appendix \u2013 Makefile pre GitHub Pages (A/B re\u017eimy)","description":"-","source":"@site/docs/sk/knifes/K000067-github-deployment-strategie/K000067_makefile_appendix.md","sourceDirName":"sk/knifes/K000067-github-deployment-strategie","slug":"/sk/knifes/K000067-github-deployment-strategie/K000067_makefile_appendix","permalink":"/sk/knifes/K000067-github-deployment-strategie/K000067_makefile_appendix","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"KNIFE","permalink":"/tags/knife"}],"version":"current","frontMatter":{"id":"K000067_makefile_appendix","guid":"da331cd7-ea63-41fc-ab47-216b48f9eed9","dao":"knife","title":"K000067 Appendix \u2013 Makefile pre GitHub Pages (A/B re\u017eimy)","description":"-","author":"Roman Kazi\u010dka","authors":["Roman Kazi\u010dka"],"category":"-","type":"-","priority":"-","tags":["KNIFE"],"created":"2025-09-24","modified":"-","status":"draft","locale":"sk","sidebar_label":"K000067 Appendix \u2013 Makefile pre GitHub Pages (A/B re\u017eimy)","rights_holder_content":"Roman Kazi\u010dka","rights_holder_system":"Roman Kazi\u010dka (CAA/KNIFE/LetItGrow)","license":"CC-BY-NC-SA-4.0","disclaimer":"Use at your own risk. Methods provided as-is; participation is voluntary and context-aware.","copyright":"\xa9 2025 Roman Kazi\u010dka / SystemThinking","author_id":"-","author_did":"-"},"sidebar":"docs","previous":{"title":"K000067 Appendix \u2013 docusaurus.config.ts (ENV\u2011driven)","permalink":"/sk/knifes/K000067-github-deployment-strategie/K000067_docusaurus_config_ts_appendix"},"next":{"title":"K000067 GitHub Deployment Strategie","permalink":"/sk/knifes/K000067-github-deployment-strategie/K000067-github-deployment-strategie-01"}}');var o=i(4848),a=i(8453);const t={id:"K000067_makefile_appendix",guid:"da331cd7-ea63-41fc-ab47-216b48f9eed9",dao:"knife",title:"K000067 Appendix \u2013 Makefile pre GitHub Pages (A/B re\u017eimy)",description:"-",author:"Roman Kazi\u010dka",authors:["Roman Kazi\u010dka"],category:"-",type:"-",priority:"-",tags:["KNIFE"],created:"2025-09-24",modified:"-",status:"draft",locale:"sk",sidebar_label:"K000067 Appendix \u2013 Makefile pre GitHub Pages (A/B re\u017eimy)",rights_holder_content:"Roman Kazi\u010dka",rights_holder_system:"Roman Kazi\u010dka (CAA/KNIFE/LetItGrow)",license:"CC-BY-NC-SA-4.0",disclaimer:"Use at your own risk. Methods provided as-is; participation is voluntary and context-aware.",copyright:"\xa9 2025 Roman Kazi\u010dka / SystemThinking",author_id:"-",author_did:"-"},r="K000067 Appendix \u2013 Makefile pre GitHub Pages (A/B re\u017eimy)",l={},d=[{value:"Predpoklady",id:"predpoklady",level:2},{value:"<code>package.json</code> \u2013 minim\xe1lne skripty",id:"packagejson--minim\xe1lne-skripty",level:2},{value:"Makefile (kompletn\xfd)",id:"makefile-kompletn\xfd",level:2},{value:"Pozn\xe1mky k pou\u017eitiu",id:"pozn\xe1mky-k-pou\u017eitiu",level:2},{value:"Hromadn\xfd init (pre desiatky repozit\xe1rov)",id:"hromadn\xfd-init-pre-desiatky-repozit\xe1rov",level:2},{value:"Troubleshooting (skratka)",id:"troubleshooting-skratka",level:2},{value:"S\xfavisiace",id:"s\xfavisiace",level:2}];function c(e){const n={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"k000067-appendix--makefile-pre-github-pages-ab-re\u017eimy",children:"K000067 Appendix \u2013 Makefile pre GitHub Pages (A/B re\u017eimy)"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"GUID:"})," ",(0,o.jsx)(n.code,{children:'"da331cd7-ea63-41fc-ab47-216b48f9eed9"'})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Category:"})," ",(0,o.jsx)(n.code,{children:'""'})," \xb7 ",(0,o.jsx)(n.strong,{children:"Type:"})," ",(0,o.jsx)(n.code,{children:'""'})," \xb7 ",(0,o.jsx)(n.strong,{children:"Status:"})," ",(0,o.jsx)(n.code,{children:"draft"})," \xb7 ",(0,o.jsx)(n.strong,{children:"Author:"})," Roman Kazi\u010dka \xb7 ",(0,o.jsx)(n.strong,{children:"License:"}),' "CC-BY-NC-SA-4.0"']}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Tento appendix obsahuje ",(0,o.jsx)(n.strong,{children:"kompletn\xfd Makefile"})," pre \u0161abl\xf3nu ",(0,o.jsx)(n.code,{children:"git_class_template_v1"})," s dvomi nasadzovac\xedmi re\u017eimami:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"A \u2013 Branch deploy (default pre triedy)"}),": pou\u017e\xedva vstavan\xe9 ",(0,o.jsx)(n.code,{children:"docusaurus deploy"})," \u2192 push na ",(0,o.jsx)(n.code,{children:"gh-pages"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"B \u2013 Actions deploy (ofici\xe1lny Pages workflow)"}),": build v CI \u2192 ",(0,o.jsx)(n.code,{children:"deploy-pages@v4"})," \u2192 environment ",(0,o.jsx)(n.code,{children:"github-pages"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Hlavn\xfd \u010dl\xe1nok a krit\xe9ri\xe1 v\xfdberu n\xe1jde\u0161 v ",(0,o.jsx)(n.strong,{children:"K000067 \u2013 GitHub Pages \u2013 strat\xe9gie nasadzovania (A/B/C)"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"predpoklady",children:"Predpoklady"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Node.js 20 (pozri ",(0,o.jsx)(n.code,{children:".nvmrc"}),")"]}),"\n",(0,o.jsx)(n.li,{children:"NPM (alebo pnpm/yarn \u2013 prisp\xf4sob pr\xedkazy)"}),"\n",(0,o.jsx)(n.li,{children:"Pre re\u017eim B: povolen\xe9 GitHub Actions a Pages v repozit\xe1ri"}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.h2,{id:"packagejson--minim\xe1lne-skripty",children:[(0,o.jsx)(n.code,{children:"package.json"})," \u2013 minim\xe1lne skripty"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "scripts": {\n    "start": "docusaurus start",\n    "build": "CUSTOM_DOMAIN=${CUSTOM_DOMAIN:-} docusaurus build",\n    "deploy": "docusaurus deploy"\n  }\n}\n'})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"docusaurus deploy"})," automaticky pushuje na vetvu ",(0,o.jsx)(n.code,{children:"gh-pages"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"makefile-kompletn\xfd",children:"Makefile (kompletn\xfd)"}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Vlo\u017e do kore\u0148a repozit\xe1ra ako ",(0,o.jsx)(n.code,{children:"Makefile"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-make",children:'# =========================\n# Makefile \u2013 Docusaurus + GitHub Pages (A/B)\n# =========================\nSHELL := /bin/bash\nNODE  := node\nNPM   := npm\n\n# Re\u017eim (len informa\u010dn\xfd \u2013 skuto\u010dn\xfd prep\xedna\u010d robia ciele use-branch/use-actions)\nMODE ?= branch     # branch | actions\nDOMAIN ?=          # pre custom dom\xe9nu (CNAME)\n\n.PHONY: install dev build serve mode \\\n        set-domain unset-domain \\\n        use-branch use-actions \\\n        init-pages-branch deploy-branch \\\n        init-pages-actions deploy-actions \\\n        gh-init-pages gh-pages-status\n\n# -------------------------\n# Z\xe1klad\n# -------------------------\ninstall: ; $(NPM) ci\n\ndev: ; $(NPM) start\n\nbuild: ; $(NPM) run build\n\nserve: ; $(NPM) run serve\n\nmode:\n\t@echo "MODE=$(MODE)"; \\\n\tif [ "$(MODE)" = "branch" ]; then \\\n\t  echo "\u2192 Branch deploy (gh-pages)"; \\\n\telse \\\n\t  echo "\u2192 Actions deploy (GitHub Pages workflow)"; \\\n\tfi\n\n# -------------------------\n# Custom domain helper (CNAME)\n# -------------------------\nset-domain:\n\t@if [ -z "$(DOMAIN)" ]; then echo "Pou\u017eitie: make set-domain DOMAIN=sub.domain.tld"; exit 1; fi\n\tmkdir -p static && echo "$(DOMAIN)" > static/CNAME\n\tgit add static/CNAME && git commit -m "chore: set CNAME $(DOMAIN)" || true\n\t@echo "\u2705 CNAME ulo\u017een\xfd. Nezabudni DNS CNAME \u2192 <org>.github.io"\n\nunset-domain:\n\trm -f static/CNAME || true\n\tgit add -A && git commit -m "chore: unset CNAME" || true\n\t@echo "\u2705 CNAME odstr\xe1nen\xfd"\n\n# -------------------------\n# A) Branch deploy (jednoduch\xfd)\n# -------------------------\nuse-branch:\n\t@[ -f .github/workflows/deploy.yml ] && mv .github/workflows/deploy.yml .github/workflows/deploy.yml.disabled || true\n\tgit add -A && git commit -m "ci: use Branch deploy (disable Actions)" || true\n\t@echo "\ud83d\udd27 ENABLED Branch deploy. Teraz nastav v UI: Settings \u2192 Pages \u2192 Source: gh-pages (root)."\n\ninit-pages-branch:\n\t@echo "\u27a1\ufe0f  V UI nastav: Settings \u2192 Pages \u2192 Build and deployment = Deploy from branch" \\\n\t      "\u2192 branch: gh-pages, folder: /(root)"\n\n# Vstavan\xe9 v Docusauruse \u2013 push na gh-pages\ndeploy-branch:\n\t$(NPM) run deploy\n\n# -------------------------\n# B) Actions deploy (ofici\xe1lny)\n# -------------------------\nuse-actions:\n\t@mkdir -p .github/workflows\n\t@[ -f .github/workflows/deploy.yml.disabled ] && mv .github/workflows/deploy.yml.disabled .github/workflows/deploy.yml || true\n\tgit add -A && git commit -m "ci: enable Actions deploy" || true\n\t@echo "\ud83d\udd27 ENABLED Actions workflow. Spus\u0165: make init-pages-actions"\n\n# Manu\xe1lny init \u2013 ak nechce\u0161 pou\u017e\xedva\u0165 gh CLI\ninit-pages-actions:\n\t@echo "\u27a1\ufe0f  Settings \u2192 Pages \u2192 Source = GitHub Actions (ulo\u017ei\u0165)"; \\\n\techo "\u27a1\ufe0f  Settings \u2192 Environments \u2192 create \'github-pages\' (bez reviewers/wait timer)"; \\\n\techo "\u27a1\ufe0f  Settings \u2192 Actions \u2192 Workflow permissions: Read & write";\n\n# V CI sta\u010d\xed push do main alebo Run workflow\ndeploy-actions:\n\t@echo "Pushni do main alebo spusti workflow ru\u010dne (Run workflow v Actions)."\n\n# -------------------------\n# (Volite\u013en\xe9) Automatizovan\xfd init cez gh CLI\n# -------------------------\n# Po\u017eiadavky: gh auth login; pr\xe1va na repo\nORG ?= $(shell git config --get remote.origin.url | sed -E \'s#.*/([^/]+)/[^/]+(\\.git)?#\\1#\')\nREPO ?= $(shell basename -s .git `git rev-parse --show-toplevel`)\n\n# Vytvor\xed env, zapne Pages=Actions, nastav\xed permissions\ngh-init-pages:\n\t@echo "\ud83d\udd27 gh-init-pages pre $(ORG)/$(REPO)\u2026"; \\\n\tgh api -X PUT repos/$(ORG)/$(REPO)/environments/github-pages >/dev/null; \\\n\tgh api -X POST repos/$(ORG)/$(REPO)/pages -f build_type=workflow >/dev/null 2>&1 || true; \\\n\tgh api -X PUT  repos/$(ORG)/$(REPO)/pages -F build_type=workflow >/dev/null; \\\n\tgh api -X PUT repos/$(ORG)/$(REPO)/actions/permissions -f enabled=true -f allowed_actions=all >/dev/null; \\\n\techo "\u2705 Hotovo. Teraz pushni do main a sleduj Actions."\n\ngh-pages-status:\n\t@gh api repos/$(ORG)/$(REPO)/pages | jq \'{status, cname, https_enforced, build_type}\' || echo "\u26a0\ufe0f Pages e\u0161te nie s\xfa inicializovan\xe9"\n'})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"pozn\xe1mky-k-pou\u017eitiu",children:"Pozn\xe1mky k pou\u017eitiu"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Default pre triedy"}),": pou\u017ei ",(0,o.jsx)(n.code,{children:"use-branch"})," + ",(0,o.jsx)(n.code,{children:"deploy-branch"})," a raz nastav Pages na ",(0,o.jsx)(n.code,{children:"gh-pages (root)"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Actions re\u017eim"}),": pou\u017e\xedvaj tam, kde chce\u0161 audit/deploymenty a pravidl\xe1. Iniciuj cez ",(0,o.jsx)(n.code,{children:"use-actions"})," + ",(0,o.jsx)(n.code,{children:"init-pages-actions"})," (alebo ",(0,o.jsx)(n.code,{children:"gh-init-pages"}),")."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Custom dom\xe9na"}),": ",(0,o.jsx)(n.code,{children:"make set-domain DOMAIN=\u2026"})," + DNS CNAME. V ",(0,o.jsx)(n.code,{children:"docusaurus.config.ts"})," nech rozhoduje ",(0,o.jsx)(n.code,{children:"CUSTOM_DOMAIN"})," (pozri s\xfabor ",(0,o.jsx)(n.em,{children:"K000067_docusaurus_configuration.md"}),")."]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"hromadn\xfd-init-pre-desiatky-repozit\xe1rov",children:"Hromadn\xfd init (pre desiatky repozit\xe1rov)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'# vy\u017eaduje: gh auth login\nORG="06-STH-Projects"\nfor REPO in $(gh repo list $ORG --limit 200 --json name -q \'.[].name\' | grep \'^class_\'); do\n  echo ">>> $ORG/$REPO"\n  gh api -X PUT repos/$ORG/$REPO/environments/github-pages >/dev/null\n  gh api -X POST repos/$ORG/$REPO/pages -f build_type=workflow >/dev/null 2>&1 || true\n  gh api -X PUT  repos/$ORG/$REPO/pages -F build_type=workflow >/dev/null\n  gh api -X PUT repos/$ORG/$REPO/actions/permissions -f enabled=true -f allowed_actions=all >/dev/null\n  echo "OK"\ndone\n'})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"troubleshooting-skratka",children:"Troubleshooting (skratka)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"404: Ensure GitHub Pages has been enabled"})," \u2192 ch\xfdba env ",(0,o.jsx)(n.code,{children:"github-pages"})," alebo Pages=Actions (init pod\u013ea vy\u0161\u0161ie)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsxs)(n.strong,{children:["Ch\xfdba ",(0,o.jsx)(n.code,{children:"pages-build-deployment"})]})," \u2192 objav\xed sa a\u017e po prvom \xfaspe\u0161nom ",(0,o.jsx)(n.code,{children:"deploy-pages@v4"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsxs)(n.strong,{children:["\u017dlt\xfd banner o ",(0,o.jsx)(n.code,{children:"baseUrl"})]})," \u2192 zl\xe1 kombin\xe1cia ",(0,o.jsx)(n.code,{children:"url/baseUrl"}),"; pozri ",(0,o.jsx)(n.em,{children:"K000067_docusaurus_configuration.md"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"HTTPS nejde na custom dom\xe9ne"})," \u2192 invalid CNAME (napr. pod\u010diarkovn\xedk) alebo \u010dak\xe1\u0161 na DNS."]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"s\xfavisiace",children:"S\xfavisiace"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.em,{children:"K000067 \u2013 GitHub Pages \u2013 strat\xe9gie nasadzovania (A/B/C)"})}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.em,{children:"K000067_docusaurus_configuration.md"})," \u2013 univerz\xe1lny ",(0,o.jsx)(n.code,{children:"docusaurus.config.ts"})," (ENV-driven)"]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>r});var s=i(6540);const o={},a=s.createContext(o);function t(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);